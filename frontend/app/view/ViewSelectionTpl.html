<span class="badge" *ngFor='let tag of selectedTags'>{{tag}}</span>

<div *ngIf="listShape == 'structured'">
  <clr-tree-node *ngFor='let key of list | keys' [clrTreeNodeExpanded]="false">
      {{key.key}}
      <clr-tree-node *ngFor='let key2 of key.value | keys' [clrTreeNodeExpanded]="false">
          {{key2.key}}
          <clr-tree-node [clrTreeNodeExpanded]="true">
              <clr-datagrid>
                  <clr-dg-column>Title</clr-dg-column>
                  <clr-dg-column>Artist</clr-dg-column>
                  <clr-dg-column>Tags</clr-dg-column>
                  <clr-dg-column>BPM</clr-dg-column>
                  <clr-dg-column>Key</clr-dg-column>
                  <clr-dg-column>Structure</clr-dg-column>

                  <clr-dg-row *ngFor='let key3 of key2.value | keys'>
                      <clr-dg-cell >{{key3.value.title}}</clr-dg-cell>
                      <clr-dg-cell>{{key3.value.artist}}</clr-dg-cell>
                      <clr-dg-cell>
                        <span class="badge" (click)="selectTag(tag);" *ngFor='let tag of key3.value.tags'>{{tag}}</span>
                        <input type="text" id="field_tag" [(ngModel)]="key3.value.newTag" placeholder="New tag">
                        <clr-icon shape="add" size="15" (click)="updateDoc(key3.value);"></clr-icon>
                      </clr-dg-cell>
                      <clr-dg-cell>{{key3.value.bpm}}</clr-dg-cell>
                      <clr-dg-cell>{{key3.value.key}}</clr-dg-cell>
                      <clr-dg-cell>
                        <span *ngIf="key3.value.structure"> {{key3.value.structure[currentSelection]}}</span> 
                        <form>
                          <section class="form-block">
                              <div class="form-group">
                                  <div class="select">
                                      <select [(ngModel)]="struct" (change)="structureChanged(key3.value, 0, struct)" name="selectItem">
                                          <option *ngFor="let key of list | keys" [ngValue]="key.key">{{key.key}}</option>
                                      </select>
                                  </div>
                                  <div class="select">
                                      <select [(ngModel)]="struct" (change)="structureChanged(key3.value, 1, struct)" name="selectItem">
                                          <option *ngFor="let key2 of key.value | keys" [ngValue]="key2.key">{{key2.key}}</option>
                                      </select>
                                  </div>
                              </div>
                          </section>
                      </form>
                      </clr-dg-cell>
                  </clr-dg-row>
                  <clr-dg-footer>tracks</clr-dg-footer>
              </clr-datagrid>
          </clr-tree-node>
      </clr-tree-node>
  </clr-tree-node>
</div>

<div *ngIf="listShape == 'unstructured'">
  <clr-tree-node [clrTreeNodeExpanded]="true">
      <clr-datagrid>
          <clr-dg-column>Title</clr-dg-column>
          <clr-dg-column>Artist</clr-dg-column>
          <clr-dg-column>Tags</clr-dg-column>
          <clr-dg-column>BPM</clr-dg-column>
          <clr-dg-column>Key</clr-dg-column>
          <clr-dg-column>Structure</clr-dg-column>

          <clr-dg-row *ngFor='let key of list | keys'>
              <clr-dg-cell >{{key.value.title}}</clr-dg-cell>
              <clr-dg-cell>{{key.value.artist}}</clr-dg-cell>
              <clr-dg-cell>
                <span class="badge" (click)="selectTag(tag);"  *ngFor='let tag of key.value.tags'>{{tag}}</span>
                <input type="text" id="field_tag" [(ngModel)]="key.value.newTag" placeholder="New tag">
                <clr-icon shape="add" size="15" (click)="updateDoc(key.value);"></clr-icon>
              </clr-dg-cell>
              <clr-dg-cell>{{key.value.bpm}}</clr-dg-cell>
              <clr-dg-cell>{{key.value.key}}</clr-dg-cell>
              <clr-dg-cell>{{key.value.structure}}</clr-dg-cell>
          </clr-dg-row>

          <clr-dg-footer>tracks</clr-dg-footer>
      </clr-datagrid>
  </clr-tree-node>
</div>
